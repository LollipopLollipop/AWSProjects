<!DOCTYPE html><html><head xmlns:md="http://oli.web.cmu.edu/metadata/"><META http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta content="IE=9" http-equiv="X-UA-Compatible"><meta content="/repository/presentation/whirlwind-1.2/" name="themePath"><title>Flat Files</title><base href="https://oli.cmu.edu/repository/webcontent/fda7217280020ca6017598f75d250b76/projects/_p03_project_3/_p03_m01_databases/x-oli-workbook_page/_p03_m01_1_intro.xml"><link rel="StyleSheet" type="text/css" href="/repository/presentation/whirlwind-1.2/web/styles/reset.css"><link rel="StyleSheet" type="text/css" href="/repository/presentation/whirlwind-1.2/web/styles/learning_content.css"><link rel="StyleSheet" type="text/css" href="/repository/presentation/whirlwind-1.2/web/styles/azool.css"><link rel="StyleSheet" type="text/css" href="/repository/presentation/whirlwind-1.2/web/styles/style.css"><link rel="StyleSheet" type="text/css" href="/repository/presentation/whirlwind-1.2/web/styles/mBoxCore.css"><link rel="StyleSheet" type="text/css" href="/repository/presentation/whirlwind-1.2/web/styles/mBoxModal.css"><!--[if lte IE 7.0]>
        <link rel="stylesheet" href="/repository/presentation/whirlwind-1.2/web/styles/ie/ie7.css" type="text/css" />
        <![endif]-->
        <!--[if lte IE 6]>
        <link rel="stylesheet" href="/branding/css/ielte6.css" type="text/css" />
        <![endif]--><link rel="StyleSheet" type="text/css" href="/repository/presentation/whirlwind-1.2/web/workbook_page/workbook_page.css"><!--[if IE 7]><![endif]--><script src="/repository/presentation/whirlwind-1.2/web/scripts/swfobject.js" type="text/javascript"></script><script src="/repository/presentation/whirlwind-1.2/web/scripts/mootools-core-1.4.5-full-compat.js" type="text/javascript"></script><script src="/repository/presentation/whirlwind-1.2/web/scripts/mootools-more-1.4.0.1.js" type="text/javascript"></script><script src="/repository/presentation/whirlwind-1.2/web/scripts/mootests.js" type="text/javascript"></script><script src="/repository/presentation/whirlwind-1.2/web/scripts/mBox.Core.min.js" type="text/javascript"></script><script src="/repository/presentation/whirlwind-1.2/web/scripts/mBox.Modal.min.js" type="text/javascript"></script><script src="/repository/presentation/whirlwind-1.2/web/scripts/azool.js" type="text/javascript"></script><script src="/oa.js" type="text/javascript"></script><script type="text/javascript" src="/repository/presentation/whirlwind-1.2/web/workbook_page/workbook_page.js">//</script><script type="text/javascript">var AZ = AZ ? AZ : {};
AZ.d = {'courseKey': 'F14-CC-PSA', 'pageNumber': '166'};
</script><link type="text/css" rel="stylesheet" href="/repository/presentation/whirlwind-1.2/web/styles//syntax/shCore.css"><link type="text/css" rel="stylesheet" href="/repository/presentation/whirlwind-1.2/web/styles//syntax/shThemeEclipse.css"><script src="/repository/presentation/whirlwind-1.2/web/scripts//syntax/shCore.js" type="text/javascript"> </script><script src="/repository/presentation/whirlwind-1.2/web/scripts//syntax/shBrushPlain.js" type="text/javascript"> </script><script type="text/javascript">SyntaxHighlighter.config.clipboardSwf = '/repository/presentation/whirlwind-1.2/web/scripts//syntax/clipboard.swf';SyntaxHighlighter.all();</script></head><body class="workbook_page"><div class="contain"><div role="banner" class="header"><div class="oliClassTitle"><a class="logo"></a><h1><a title="15319/15619 Cloud Computing (Fall 2014)" href="/jcourse/lms/students/syllabus.do?section=0e4f7c4380020ca600aa44ba1eaf4b1e">15319/15619 Cloud Computing (Fall 2014)</a></h1></div><div aria-label="system" role="navigation" class="user"><h3>System Navigation</h3><ul class="userCredentials"><li class="userName"><a title="Edit my account" id="username" href="/jcourse/webui/myaccount/edit.do?user=dingz@andrew.cmu.edu">Ding ZHAO</a></li> <li class="login"><a title="Logout of the Open Learning Initiative." class="signout" href="/jcourse/webui/logout.do?from=0e4f808180020ca600aac8e6daeb4cd9">
                            [  Sign Out  ]
						</a></li></ul><div class="clear"></div><ul class="userHelp"><li><a title="Access Key + C" accesskey="C" class="home" id="myCourses" href="/jcourse/webui/myhome.do">My Courses</a>|
				</li><li><a title="Access Key + S" accesskey="S" class="mimetypes_x-office-address-book" id="syllabus" href="/jcourse/lms/students/syllabus.do?section=0e4f7c4380020ca600aa44ba1eaf4b1e">Syllabus</a>|
			</li><li><span class="coursenav"> <a class="active" href="/jcourse/webui/syllabus/outline.do?section=0e4f7c4380020ca600aa44ba1eaf4b1e&from=0e4f808180020ca600aac8e6daeb4cd9">
	      
	        
			Outline
	    </a></span>|
			</li><li><a onclick="openMdWin(this.href, 'activity');return false;" title="Ask OLI technical support team" href="/jcourse/webui/help.do">Help</a>|
			</li><li id="moreBtn2"><a aria-haspopup="true" href="" tabindex="" title="More" accesskey="M" id="moreBtn">
					More
				</a></li></ul></div><div class="shadowOne" id="wn"><span class="controlpanel"> <a target="_blank" href="/jcourse/GradebookClient/index.html?myscores&section=0e4f7c4380020ca600aa44ba1eaf4b1e&col=0e4f807f80020ca601da17cb73b7cb68"><span class="gradebook">My Scores</span></a><a href="/jcourse/webui/mycourses/reports/practice.do?section=0e4f7c4380020ca600aa44ba1eaf4b1e&context=0e4f807f80020ca601da17cb73b7cb68"><span class="studentDashboard">Available Practice</span></a></span><span class="supportPanel"> <a title="Check if my computer is configured properly for this course." href="/jcourse/webui/help/configure/redirect.do?section=0e4f7c4380020ca600aa44ba1eaf4b1e"><span class="categories_preferences-system">Test My System</span></a> <a title="Send email to Majd Sakr" href="mailto:msakr@ANDREW.CMU.EDU"><span class="actions_mail-message-new">Email Sakr</span></a> <a onclick="openMdWin(this.href, 'activity');return false;" class="wnTechSupport" title="Ask OLI technical support team" href="/jcourse/webui/help.do"><span class="actions_mail-message-new">Email Tech Support</span></a></span></div></div><div aria-haspopup="true" aria-label="Unit" role="navigation" class="lessonHead"><h2 tabindex="" accesskey="u" id="0e4f807c80020ca6008491878136e895"><a tabindex="" href="javascript:;"><span>Unit&nbsp;::</span>Project 3</a></h2></div><div class="expand shadowOne"><ul id="topLvl"></ul></div><div aria-label="module, page" role="navigation" class="subNavigation"><a aria-label="previous, module" role="navigation" accesskey="," class="prev oneclick" href="javascript:;"></a><a aria-label="next, module" role="navigation" accesskey="." class="next oneclick" href="javascript:;"></a><div class="module"><ul id="moduleUl"><li class="current"><a id="0e4f807f80020ca601da17cb73b7cb68" title="Module  Files vs. Databases" rel="" href="/jcourse/webui/syllabus/module.do?context=0e4f807f80020ca601da17cb73b7cb68"><b><span>Files vs. Databases</span></b></a></li><li><a id="0e4f808780020ca600d665bde281f8be" title="Module  Vertical Scaling in Databases" rel="" href="/jcourse/webui/syllabus/module.do?context=0e4f808780020ca600d665bde281f8be"><b><span>Vertical Scaling in Databases</span></b></a></li><li><a id="0e4f809080020ca601c500941f6401a7" title="Module  Horizontal Scaling in Databases" rel="" href="/jcourse/webui/syllabus/module.do?context=0e4f809080020ca601c500941f6401a7"><b><span>Horizontal Scaling in Databases</span></b></a></li><li><a id="0e4f809780020ca600b2808990fdcd15" title="Module  Working with NoSQL: DynamoDB / HBase" rel="" href="/jcourse/webui/syllabus/module.do?context=0e4f809780020ca600b2808990fdcd15"><b><span>Working with NoSQL: DynamoDB / HBase</span></b></a></li></ul></div><div class="subMenu shadowOne" id="subMenuExpand"><ul id="jsonSubMenu"></ul></div></div><div class="searchBox"><form method="get" action="/jcourse/search/search.do" id="searchForm"><input value="0e4f7c4380020ca600aa44ba1eaf4b1e" type="hidden" name="section" class="sectionGUID"><input placeholder="Search this course" onBlur="this.setAttribute('value', this.value);" value="" size="25" id="q" type="text" name="q" class="q"><input value="0e4f808180020ca600aac8e6daeb4cd9" type="hidden" name="from" class="contextGUID"></form></div><div class="opacity"><div role="main" class="content shadowTwo"><div id="oli-message"><!----></div><div id="paginationtopwrap"><div class="clearfix" id="paginationtop"><div class="pagtopwrapwrap"><div class="pagtopwrap"><div aria-label="page" role="navigation" class="pagtop"><a aria-label="previous" role="navigation" title="Cost Management and Fault Tolerance" class="prev oneclick degree2" accesskey="Ctrl+Arrow Left" href="/jcourse/workbook/activity/page?context=0e4f807780020ca601a238815d4373e5"></a> <a aria-label="previous" role="navigation" title="Files vs. Databases" class="prev oneclick degree1" accesskey="Ctrl+Arrow Left" href="/jcourse/webui/syllabus/module.do?context=0e4f807f80020ca601da17cb73b7cb68"></a> <span class="pagnum"><form method="get" class="pageForm" style="" action="/jcourse/webui/syllabus/page.do?section=0e4f7c4380020ca600aa44ba1eaf4b1e"><label for="pagenumnewinput"><span style="display:none" class="pageTip" id="pagnumtip">Enter Page 1-185, then press Enter</span></label><input value="185" type="hidden" class="pageMax"><input size="4" autocomplete="off" value="166" type="text" class="paginationInput"> </form></span><a aria-label="next" role="navigation" title="Next: Databases" accesskey="Ctrl+Arrow Right" class="next oneclick degree1" href="/jcourse/workbook/activity/page?context=0e4f808380020ca6009633f4757424d6"></a></div></div></div><h3><a href="/jcourse/webui/syllabus/module.do?context=0e4f807f80020ca601da17cb73b7cb68" class="module-heading"></a>Flat Files</h3></div></div><div class="contentContain">
		<p>
			This project includes several modules, the main aim is to provide students with
			experience and insight into different cloud storage services, and to
			understand their advantages and potential limitations. The experience
			will reinforce some of the concepts from the unit on Cloud Storage. To
			begin with, in this first module, you will explore the differences in
			functionality between flat files and databases. In subsequent modules
			you will evaluate vertical scaling (scale-up) and
			horizontal scaling (scale-out) of storage systems and learn about other cloud storage services
			and abstractions. Let us start with the first module.
		</p>
		
		<p>Note: Please check the <a href="https://piazza.com/class/hxs4b3o2lox5f9?cid=917" id="_i_0" target="_blank">pinned post on Piazza</a> for any updates and changes to this project write-up.</p>
		<p>For this checkpoint, assign the tag with Key: <code>Project</code> and Value: <code>3.1</code> for all resources.</p>
		
		<div id="N106F0" class="section"><div class="sectionContain ">
		<h2>
		Carnegie Records
		</h2>
		
			<p>You were hired by a records company, Carnegie Records
				(CR), as a music data analytics consultant. Before
				adopting cloud storage services, CR would like your help to evaluate
				the functionality and limitations in adopting flat files or relational
				databases to query and perform basic analytics on their data. You will
				commence your work with files and move on to databases.
			</p>
		
			<p>As a first
				step in this process, CR has provided their dataset and a database as a saved instance on
				AWS. To get started, launch an m1.small instance of the AMI &ndash;
				<code>ami-0656eb6e</code> on AWS. In the directory <code>/home/ubuntu/songs/</code>, you will find
				two comma-separated files (csv), titled <code>million_songs_metadata.csv</code> and
				<code>million_songs_sales_data.csv</code>. The <code>million_songs_metadata.csv</code> is all of
				the track metadata from the Million Song Dataset that CR uses and the
				<code>million_songs_sales_data.csv</code> has daily record sales count for CR for
				each song for a finite period of time. The two formats of the two files
				are as shown below.
			</p>
		
			<p>The file <code>million_songs_metadata.csv</code> has the following columns:</p>
			
		<table class="table labeled " id="N10715_bx"><tfoot><tr><td class="captionwrap"><span class="caption">Table 1: MySQL Data Schema for <code>million_songs_metadata.csv</code></span></td></tr></tfoot><tbody><tr><td><table cellspacing="0" class="wbtable " align="center"><thead><tr><th>Col #</th><th>Name</th><th>MySQL type</th></tr></thead><tbody><tr>
				<td>1</td>
				<td>track_id</td>
				<td>text(19)</td>
			</tr><tr class="e">
				<td>2</td>
				<td>title</td>
				<td>text</td>
			</tr><tr>
				<td>3</td>
				<td>song_id</td>
				<td>text</td>
			</tr><tr class="e">
				<td>4</td>
				<td>release</td>
				<td>text</td>
			</tr><tr>
				<td>5</td>
				<td>artist_id</td>
				<td>text</td>
			</tr><tr class="e">
				<td>6</td>
				<td>artist_mbid</td>
				<td>text</td>
			</tr><tr>
				<td>7</td>
				<td>artist_name</td>
				<td>text</td>
			</tr><tr class="e">
				<td>8</td>
				<td>duration</td>
				<td>double</td>
			</tr><tr>
				<td>9</td>
				<td>artist_familiarity</td>
				<td>double</td>
			</tr><tr class="e">
				<td>10</td>
				<td>artist_hotttnesss</td>
				<td>double</td>
			</tr><tr>
				<td>11</td>
				<td>year</td>
				<td>int(11)</td>
			</tr></tbody></table></td></tr></tbody></table>
  	
  	<p>The file <code>million_songs_sales_data.csv</code> has the following columns:</p>
  	
  	<table class="table labeled " id="N107B3_bx"><tfoot><tr><td class="captionwrap"><span class="caption">Table 2: MySQL Data Schema for <code>million_songs_sales_data.csv</code></span></td></tr></tfoot><tbody><tr><td><table cellspacing="0" class="wbtable " align="center"><thead><tr><th>Col #</th><th>Name</th><th>MySQL type</th></tr></thead><tbody><tr>
				<td>1</td>
				<td>track_id</td>
				<td>text(19)</td>
			</tr><tr class="e">
				<td>2</td>
				<td>sales_date</td>
				<td>datetime</td>
			</tr><tr>
				<td>3</td>
				<td>sales_count</td>
				<td>int(11)</td>
			</tr></tbody></table></td></tr></tbody></table>
					
		
		</div></div>
		
		<div id="N107ED" class="section"><div class="sectionContain ">
		<h2>Part 1: Operations on Flat Files</h2>
		
		
		<p>As a good consultant, you need to learn the tools necessary to
			carry out the job presented to you by CR. So, before you start working
			with the operations on flat files make sure you read about the
			<a href="http://unixhelp.ed.ac.uk/CGI/man-cgi?grep" id="_i_1" target="_blank">grep</a> and <a href="http://www.gnu.org/software/gawk/manual/gawk.html" id="_i_2" target="_blank">awk</a>
			tools in Unix. Now that you have quickly become an expert, start by completing the
			following tasks:
		</p>
				
	
	<ol><li>	
      <p>Use the following to find the records that contain &lsquo;<code>The Beatles</code>&rsquo;, while understanding the
      difference between the 2 commands below:</p>
       
        <div><pre class="brush: text; gutter: false; highlight: [false]; ">
          grep -P 'The Beatles' million_songs_metadata.csv
          grep -i -P 'The Beatles' million_songs_metadata.csv
        </pre></div>
  
      <p>Make a note of the number of matches (use <code>| wc -l</code> ) for the two commands 
      in the step above for the checkpoint quiz. Make sure to 
      understand why there is a difference in the output of the two commands.</p>
    </li><li>
    <p>The result of running the <code>grep</code> command returns rows that include the 
    search pattern in any matching column. What if you just wanted the ones that match the <code>artist_name</code> field?</p>
      <p>AWK is a data extraction and reporting tool. You can use <code>awk</code> to find the records with <code>artist_name</code> field
      containing 'The Beatles': </p>
      <div><pre class="brush: text; ">
        awk ' BEGIN {FS = ","} ; {if ($7 ~ /The Beatles/) { print; }}' million_songs_metadata.csv 
      </pre></div>
      <p>
        (<code>$7</code> denotes the 7th column and <code>FS=","</code> sets the field seperator to a comma)
      </p>
    </li><li>
      <p>Now, what if we wanted to know something more complicated, like
        &ldquo;How many songs are from Michael Jackson, but only from the &lsquo;80s ?&rdquo;
      </p>
        <div><pre class="brush: text; ">
          awk ' BEGIN {FS = ","} ; {if (tolower($7) ~ /michael jackson/ &amp;&amp; $11 &gt;= 1980 &amp;&amp; $11 &lt; 1990) { print; }}' million_songs_metadata.csv
        </pre></div>
      <p>
        (Column #11 is the year)
      </p>
    </li><li>
      <p>
        CR would like to know the average song duration in the dataset. They need you to 
        write an <code>awk</code> program that computes the average
        song length (using the
        <code>duration</code>
        field) over the million songs. This program should be executed using 
        a single UNIX line. Paste the command into the checkpoint below, when asked.
      </p>
    </li><li>
      <p>
        CR would like you to implement the same query to find &ldquo;How many songs are from Michael Jackson, but only from the &lsquo;80s ?&rdquo; 
        using a shell script by looping through each record in the file (use <code>while</code>, <code>for</code> or <code>foreach</code>). Make the script 
        configurable by accepting input parameters for <code>artist_name</code>, <code>start_year</code> and <code>end_year</code>. You will be asked to
        submit this shell script in the checkpoint quiz.
      </p>
    </li><li>
		<p>CR would like to consolidate the data in the two source csv files mentioned
			earlier. To do that you need to either write a program or a set of
			commands (using <code>awk</code> or <code>shell</code>) to join the records from the <code>million_songs_metadata.csv</code> file and the <code>million_songs_sales_data.csv</code> file
			using the common column <code>track_id</code>. The goal is to generate a new merged
			dataset <code>million_songs_metadata_and_sales.csv</code> with <code>track_id</code> as column
			1, <code>sales_date</code> as column 2, <code>sales_count</code> as column 3 and the other
			columns in <code>million_songs_metadata.csv</code> as columns 4 to 13. Save the output
			file and the program (or set of commands) for the checkpoint quiz.</p>
			
			<p><em class="bold">Hint</em>: Search for a unix command that lets you join two files based on a common field.</p>
    </li></ol>
 
   <p>You can see that as your questions become more complex, it is more
        difficult to write a single line of code to answer the question.
        For these reasons (among many others) we want to explore the benefits or
        limitations of moving this data to a
        database.
      </p>
      
      <p><em class="bold">Useful References</em>:</p>
		
		<ul><li><a href="http://www.gnu.org/software/gawk/manual/gawk.html" id="_i_3" target="_blank">GNU Reference for AWK</a></li><li><a href="http://unixhelp.ed.ac.uk/CGI/man-cgi?grep" id="_i_4" target="_blank">UNIX man page for grep</a></li></ul>
 
 
 
 
 </div></div>

	</div></div></div><div class="paginationBt"><div class="pagtopwrapwrap2"><div class="pagtopwrap2"><div aria-label="page" role="navigation" class="pagtop2"><a aria-label="previous" role="navigation" title="Cost Management and Fault Tolerance" class="prev oneclick degree2" accesskey="Ctrl+Arrow Left" href="/jcourse/workbook/activity/page?context=0e4f807780020ca601a238815d4373e5"></a> <a aria-label="previous" role="navigation" title="Files vs. Databases" class="prev oneclick degree1" accesskey="Ctrl+Arrow Left" href="/jcourse/webui/syllabus/module.do?context=0e4f807f80020ca601da17cb73b7cb68"></a> <span class="pagnum2"><form method="get" class="pageForm2" action="/jcourse/webui/syllabus/page.do?section=0e4f7c4380020ca600aa44ba1eaf4b1e"><label for="pagenumnewinput"><span style="display:none" class="pageTip2">Enter Page 1-185, then press Enter</span></label><input value="185" type="hidden" class="pageMax2"><input size="1" autocomplete="off" value="166" type="text" class="paginationInput2"> </form></span><a aria-label="next" role="navigation" title="Next: Databases" accesskey="Ctrl+Arrow Right" class="next oneclick degree1" href="/jcourse/workbook/activity/page?context=0e4f808380020ca6009633f4757424d6"></a></div></div></div></div><div role="contentinfo" id="tinyfooter"><a class="oli" href="/">Open Learning Initiative</a><br><span class="license" title="Creative Commons License"><a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" rel="license"><img src="https://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png" style="border-width:0" alt="Creative Commons License"></a> Unless otherwise noted this work is licensed under a <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" rel="license">Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License</a>.
			</span></div></div></body></html>